/* Modal Component Styles - Using Design Tokens */
/* Note: This file is imported after @tailwind components in index.css */

/* ============================================
   ANIMATIONS
   ============================================ */
@keyframes modal-fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes modal-fade-out {
  from { opacity: 1; }
  to { opacity: 0; }
}

@keyframes modal-scale-in {
  from { 
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.95);
  }
  to { 
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
}

@keyframes modal-slide-up {
  from { transform: translateY(100%); }
  to { transform: translateY(0); }
}

@keyframes modal-slide-down {
  from { transform: translateY(0); }
  to { transform: translateY(100%); }
}

@keyframes modal-slide-in-right {
  from { transform: translateX(100%); }
  to { transform: translateX(0); }
}

@keyframes modal-slide-out-right {
  from { transform: translateX(0); }
  to { transform: translateX(100%); }
}

/* ============================================
   OVERLAY
   ============================================ */
.app-modal-overlay {
  @apply fixed inset-0 z-[1000] bg-black/80 backdrop-blur-sm;
  animation: modal-fade-in 200ms ease-out;
}

.app-modal-overlay[data-state="closed"] {
  animation: modal-fade-out 150ms ease-in;
}

/* ============================================
   BASE MODAL CONTAINER
   ============================================ */
.app-modal {
  @apply bg-card text-card-foreground rounded-lg shadow-xl;
  @apply flex flex-col z-[1001];
  max-height: 90vh;
  max-height: 90dvh;
  overscroll-behavior: contain;
  touch-action: manipulation;
  animation: modal-scale-in 200ms ease-out;
}

.app-modal[data-state="closed"] {
  animation: modal-fade-out 150ms ease-in;
}

/* Modal Wrapper - Contains header, body, footer */
.app-modal-wrapper {
  @apply flex flex-col;
  max-height: 90vh;
  max-height: 90dvh;
  overflow: hidden;
}

/* ============================================
   SIZE VARIANTS
   ============================================ */
.app-modal-xs {
  width: 90vw;
  max-width: 20rem; /* 320px */
}

.app-modal-sm {
  width: 90vw;
  max-width: 24rem; /* 384px */
}

.app-modal-md {
  width: 90vw;
  max-width: 28rem; /* 448px */
}

.app-modal-lg {
  width: 95vw;
  max-width: 42rem; /* 672px */
}

/* ============================================
   HEADER
   ============================================ */
.app-modal-header {
  @apply flex flex-col space-y-1.5 text-center sm:text-left;
  @apply flex-shrink-0 border-b border-border;
  padding: 1rem 1.5rem;
  background-color: hsl(var(--card));
}

.app-modal-title {
  @apply text-lg font-semibold leading-none tracking-tight;
  color: hsl(var(--foreground));
}

.app-modal-subtitle {
  @apply text-sm;
  color: hsl(var(--muted-foreground));
}

/* ============================================
   BODY - Scrollable Content
   ============================================ */
.app-modal-body {
  @apply overflow-y-auto;
  @apply flex-1 min-h-0;
  padding: 1rem 1.5rem;
  background-color: hsl(var(--card));
  scroll-behavior: smooth;
  scrollbar-width: thin;
  scrollbar-color: hsl(var(--muted-foreground) / 0.3) transparent;
  overscroll-behavior: contain;
}

.app-modal-body::-webkit-scrollbar {
  width: 6px;
}

.app-modal-body::-webkit-scrollbar-track {
  background: transparent;
}

.app-modal-body::-webkit-scrollbar-thumb {
  background-color: hsl(var(--muted-foreground) / 0.3);
  border-radius: 3px;
}

.app-modal-body::-webkit-scrollbar-thumb:hover {
  background-color: hsl(var(--muted-foreground) / 0.5);
}

/* ============================================
   FOOTER
   ============================================ */
.app-modal-footer {
  @apply flex gap-3 justify-end border-t border-border;
  @apply flex-shrink-0;
  padding: 1rem 1.5rem;
  background-color: hsl(var(--card));
}

/* Mobile: Full-width stacked buttons */
@media (max-width: 639px) {
  .app-modal-footer {
    @apply flex-col-reverse;
  }
  
  .app-modal-footer > * {
    @apply w-full;
    min-height: 48px; /* Touch-friendly */
  }
}

/* ============================================
   CLOSE BUTTON
   ============================================ */
.app-modal-close {
  @apply absolute right-3 top-3 z-10 rounded-full;
  @apply bg-muted/50 hover:bg-muted;
  @apply transition-all duration-200;
  @apply focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2;
  @apply flex items-center justify-center;
  width: 2rem;
  height: 2rem;
  color: hsl(var(--muted-foreground));
}

.app-modal-close:hover {
  color: hsl(var(--foreground));
}

/* ============================================
   BOTTOM SHEET VARIANT (Small Modals on Mobile)
   ============================================ */
.app-modal-bottom-sheet {
  @apply fixed bottom-0 left-0 right-0 rounded-t-2xl;
  @apply flex flex-col;
  width: 100%;
  max-width: 100%;
  max-height: 85vh;
  max-height: 85dvh;
  animation: modal-slide-up 250ms ease-out;
  padding-bottom: env(safe-area-inset-bottom, 0);
}

.app-modal-bottom-sheet[data-state="closed"] {
  animation: modal-slide-down 200ms ease-in;
}

.app-modal-bottom-sheet .app-modal-wrapper {
  max-height: 85vh;
  max-height: 85dvh;
}

.app-modal-bottom-sheet .app-modal-body {
  max-height: calc(85vh - 10rem);
  max-height: calc(85dvh - 10rem);
}

.app-modal-bottom-sheet .app-modal-footer > * {
  @apply w-full;
  min-height: 48px;
}

/* Drag Handle */
.app-modal-drag-handle {
  @apply w-10 h-1 bg-muted-foreground/30 rounded-full mx-auto mt-3 mb-2 flex-shrink-0;
}

/* ============================================
   FULLSCREEN VARIANT (Large Modals on Mobile)
   ============================================ */
.app-modal-fullscreen {
  @apply fixed inset-0 rounded-none;
  @apply flex flex-col;
  width: 100%;
  height: 100%;
  max-width: 100%;
  max-height: 100%;
  animation: modal-slide-in-right 250ms ease-out;
  padding-top: env(safe-area-inset-top, 0);
  padding-bottom: env(safe-area-inset-bottom, 0);
}

.app-modal-fullscreen[data-state="closed"] {
  animation: modal-slide-out-right 200ms ease-in;
}

.app-modal-fullscreen .app-modal-wrapper {
  height: 100%;
  max-height: 100%;
}

.app-modal-fullscreen .app-modal-header {
  @apply sticky top-0 z-10;
  padding-top: calc(0.75rem + env(safe-area-inset-top, 0));
}

.app-modal-fullscreen .app-modal-body {
  @apply flex-1;
  max-height: none;
}

.app-modal-fullscreen .app-modal-footer {
  @apply sticky bottom-0 z-10;
  padding-bottom: calc(1rem + env(safe-area-inset-bottom, 0));
}

.app-modal-fullscreen .app-modal-footer > * {
  @apply w-full;
  min-height: 48px;
}

.app-modal-fullscreen .app-modal-close {
  top: calc(0.75rem + env(safe-area-inset-top, 0));
}

/* ============================================
   TABLET BREAKPOINT (640px - 1023px)
   ============================================ */
@media (min-width: 640px) and (max-width: 1023px) {
  .app-modal-md {
    max-width: 32rem; /* 512px */
  }
  
  .app-modal-lg {
    max-width: 40rem; /* 640px */
  }
}

/* ============================================
   REDUCED MOTION
   ============================================ */
@media (prefers-reduced-motion: reduce) {
  .app-modal-overlay,
  .app-modal,
  .app-modal-bottom-sheet,
  .app-modal-fullscreen {
    animation: none !important;
    transition: none !important;
  }
  
  .app-modal-overlay {
    opacity: 1;
  }
}
